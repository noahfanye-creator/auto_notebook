# GitHub 远程仓库项目分析报告

> 分析时间：2026-01-25  
> 远程仓库：`git@github.com:noahfanye-creator/stock-analysis-bot.git`  
> 最新提交：`116d0ba` - fix: 优化港股获取频率并彻底修复 RUN_START_TIME 变量问题

---

## 📊 项目概览

### 项目定位
一个功能完整的**股票分析机器人**，支持 A 股和港股的技术分析、报告生成和自动化任务。

### 核心特点
- ✅ **多市场支持**：A 股 + 港股
- ✅ **多数据源**：新浪财经、AKShare、东方财富（免费）
- ✅ **自动化**：GitHub Actions 定时任务
- ✅ **报告生成**：PDF 格式，包含技术分析和图表
- ✅ **行业分析**：支持行业板块指数查询

---

## 📁 项目结构

### 目录结构
```
stock-analysis-bot/
├── .github/
│   └── workflows/
│       └── stock_bot.yml          # GitHub Actions 工作流
├── config/
│   ├── config.example.yaml        # 配置示例
│   └── sector_index_map.json     # 行业板块映射表
├── docs/
│   ├── HK_DATA_SOURCES.md        # 港股数据源文档
│   ├── SECTOR_INDEX_MAP.md       # 行业板块映射文档
│   └── SECTOR_INDEX_USAGE.md     # 行业板块使用文档
├── examples/
│   ├── basic_analysis.py         # 基础分析示例
│   └── quick_start.py           # 快速开始示例
├── reports/                      # 报告输出目录（包含历史报告）
├── src/
│   ├── data/
│   │   └── hk_data_sources.py    # 港股数据源模块
│   ├── analysis/
│   │   ├── __init__.py
│   │   └── technical.py          # 技术分析模块
│   ├── visualization/
│   │   ├── __init__.py
│   │   └── charts.py             # 图表生成模块
│   ├── notify/
│   │   └── __init__.py           # 通知模块（占位）
│   └── utils/
│       └── __init__.py           # 工具函数模块
├── github_stock_bot.py           # 主程序（2175行）
├── generate_sector_reports.py    # 行业报告生成脚本
├── generate_missing_sectors.py   # 生成缺失行业脚本
├── generate_sector_group_*.sh   # 行业分组生成脚本（10个）
├── run_all_sector_groups.sh     # 运行所有行业组脚本
├── requirements.txt              # Python 依赖
├── README.md                     # 项目说明
└── SimHei.ttf                    # 中文字体文件
```

### 文件统计
- **Python 文件**：约 10+ 个
- **Shell 脚本**：12 个（行业报告生成相关）
- **配置文件**：3 个（YAML、JSON）
- **文档文件**：4 个（Markdown）
- **历史报告**：多个 PDF 和 ZIP 文件（已提交到仓库）

---

## 🔧 核心功能模块

### 1. 主程序：`github_stock_bot.py` (2175行)

#### 主要功能
- **数据获取**
  - A 股：新浪财经 API
  - 港股：新浪财经/东方财富（免费数据源）
  - 行业板块：AKShare
  - 支持多周期 K 线数据

- **技术分析**
  - 30+ 技术指标计算
  - 移动平均线（MA5/10/20/60/250）
  - MACD、RSI、KDJ、布林带、OBV 等
  - 成交量分析

- **报告生成**
  - PDF 格式报告
  - K 线图表（Matplotlib）
  - 市场指数分析
  - 行业板块分析
  - 批量处理多只股票

- **智能识别**
  - 自动识别 A 股/港股代码
  - 行业代码/名称识别（支持模糊匹配）
  - 交易时间检查

#### 命令行接口
```bash
# A股分析
python github_stock_bot.py --mode manual --stocks "600460 300474"

# 港股分析
python github_stock_bot.py --mode manual --stocks "00700 03690"

# 行业分析
python github_stock_bot.py --mode manual --stocks "BK1031" --sector "光伏设备"
```

### 2. 港股数据源：`src/data/hk_data_sources.py`

#### 功能
- 使用免费数据源获取港股数据
- 支持多周期 K 线（日/周/月/分钟级）
- 自动重试机制
- 数据清洗和格式化

### 3. 技术分析模块：`src/analysis/technical.py`

#### 功能
- 技术指标计算
- 数据预处理
- 指标标准化

### 4. 可视化模块：`src/visualization/charts.py`

#### 功能
- K 线图生成
- 技术指标图表
- 图表样式配置

### 5. 行业报告生成：`generate_sector_reports.py`

#### 功能
- 批量生成行业板块报告
- 支持行业分组处理
- 自动生成 ZIP 压缩包

---

## 🤖 GitHub Actions 自动化

### 工作流配置：`.github/workflows/stock_bot.yml`

#### 触发方式
1. **定时触发**（工作日）：
   - 11:35（A 股午盘）
   - 12:05（港股午盘）
   - 15:05（A 股收盘）
   - 16:10（港股收盘）

2. **手动触发**：
   - 支持自定义股票代码
   - 默认股票：`688630,600460,300474,300623,300019`

#### 工作流程
1. 检出代码
2. 设置 Python 环境（3.9）
3. 安装依赖（requests, pandas, numpy, reportlab, akshare, matplotlib 等）
4. 安装中文字体支持
5. 运行股票分析
6. 整理报告文件
7. 上传报告 ZIP 到 GitHub Artifacts
8. 发送 Telegram 通知（如果配置）

#### 最新优化（根据提交历史）
- ✅ 优化港股获取频率
- ✅ 修复 RUN_START_TIME 变量问题
- ✅ 完善行业报告全周期数据
- ✅ 改进行业名称检测
- ✅ 修复 ZIP 文件选择逻辑

---

## 📈 最近开发活动

### 最近 20 次提交主题
1. **港股优化**：优化港股获取频率，修复时间变量问题
2. **行业功能**：添加行业板块指数查询功能
3. **工作流优化**：完善报告生成和 ZIP 逻辑
4. **错误修复**：修复各种 YAML 缩进、变量定义等问题
5. **数据源**：更新免费港股数据源和时机

### 开发趋势
- 🔧 **持续优化**：不断修复和完善现有功能
- 🆕 **新功能**：添加行业板块分析功能
- 🐛 **问题修复**：解决 GitHub Actions 相关问题
- 📊 **数据源**：优化港股数据获取

---

## 🎯 核心特性

### 1. 多市场支持
- ✅ A 股（上海/深圳）
- ✅ 港股（自动识别 5 位数字代码）
- ✅ 自动判断交易时间

### 2. 数据源
- ✅ 新浪财经（A 股 + 港股）
- ✅ AKShare（行业板块数据）
- ✅ 东方财富（港股备选）
- ✅ 免费数据源，无需 API Key

### 3. 技术分析
- ✅ 30+ 技术指标
- ✅ 多周期分析（日/周/月/分钟）
- ✅ 市场指数对比
- ✅ 行业板块分析

### 4. 报告生成
- ✅ PDF 格式报告
- ✅ 包含 K 线图表
- ✅ 技术指标可视化
- ✅ 批量处理支持

### 5. 自动化
- ✅ GitHub Actions 定时任务
- ✅ 自动生成报告
- ✅ 自动打包 ZIP
- ✅ Telegram 通知（可选）

---

## 📚 文档完整性

### 已有文档
- ✅ `README.md` - 项目主文档
- ✅ `docs/HK_DATA_SOURCES.md` - 港股数据源说明
- ✅ `docs/SECTOR_INDEX_MAP.md` - 行业板块映射
- ✅ `docs/SECTOR_INDEX_USAGE.md` - 行业板块使用指南
- ✅ `GENERATE_SECTOR_REPORTS_README.md` - 行业报告生成说明

### 文档质量
- ✅ 文档结构清晰
- ✅ 包含使用示例
- ✅ 有功能说明
- ⚠️ 缺少 API 文档（代码注释较完整）

---

## 🔍 代码质量分析

### 优点
- ✅ **模块化设计**：功能分离清晰
- ✅ **错误处理**：有异常处理和重试机制
- ✅ **跨平台支持**：适配 macOS/Linux
- ✅ **字体处理**：自动配置中文字体
- ✅ **代码注释**：主要函数有文档字符串

### 可改进点
- ⚠️ **单文件过大**：`github_stock_bot.py` 有 2175 行，可考虑拆分
- ⚠️ **测试覆盖**：未看到测试文件
- ⚠️ **配置管理**：部分配置硬编码在代码中

---

## 🚀 使用场景

### 适用场景
1. **日常分析**：定时生成股票分析报告
2. **行业研究**：批量分析行业板块
3. **技术分析**：多指标综合分析
4. **自动化监控**：GitHub Actions 自动运行

### 目标用户
- 个人投资者
- 量化交易爱好者
- 技术分析研究者

---

## 📊 项目成熟度评估

### 功能完整性：⭐⭐⭐⭐ (4/5)
- ✅ 核心功能完整
- ✅ 多市场支持
- ✅ 自动化完善
- ⚠️ 缺少实时监控（本地开发中）

### 代码质量：⭐⭐⭐⭐ (4/5)
- ✅ 模块化设计
- ✅ 错误处理完善
- ⚠️ 单文件过大
- ⚠️ 缺少单元测试

### 文档完整性：⭐⭐⭐⭐ (4/5)
- ✅ 主要文档齐全
- ✅ 使用示例完整
- ⚠️ 缺少 API 详细文档

### 自动化程度：⭐⭐⭐⭐⭐ (5/5)
- ✅ GitHub Actions 配置完善
- ✅ 定时任务稳定
- ✅ 报告自动生成和分发

---

## 🎯 总结

### 项目优势
1. **功能完整**：从数据获取到报告生成，流程完整
2. **多市场支持**：A 股和港股都能处理
3. **自动化程度高**：GitHub Actions 定时任务稳定运行
4. **免费数据源**：无需 API Key，降低使用门槛
5. **文档齐全**：有完整的使用文档和示例

### 项目特点
- 🎯 **专注技术分析**：30+ 技术指标，分析全面
- 🔄 **自动化流程**：定时生成报告，无需人工干预
- 📊 **报告质量高**：PDF 格式，包含图表和分析
- 🌏 **多市场支持**：A 股和港股统一处理

### 适用人群
- ✅ 个人投资者进行技术分析
- ✅ 量化交易爱好者
- ✅ 需要自动化股票分析的开发者

---

**分析完成时间**：2026-01-25  
**分析工具**：Git + 代码审查
